SET ECHO ON
SET TIMING ON
SET FEEDBACK ON

SPOOL &1;

--============================================
-- 		ESPECIALIZACION BI & BIG DATA
--============================================

-- CARGA DE TABLA DIM_CLIENTE

TRUNCATE TABLE DIM_CLIENTE;

INSERT INTO DIM_CLIENTE
(
	CODMES						,
	CODSBSCLIENTE				,
	FECREPORTE					,
	TIPDOCEMPRESA				,
	RUC							,
	TIPDOCIDENTIDAD				,
	DOCIDENTIDAD				,
	TIPPERSONA					,
	TIPEMPRESA					,
	CANTEMPRESA					,
	DEUDACALIFCLIENTE			,
	CLASIFDEUDACLIENTE			,
	UBIGEO						,
	SEXO						,
	APPATERNO					,
	APMATERNO					,
	NOMBRES						,
	EDAD						,
	FECCARGATABLA				
)
SELECT 
	A.CODMES						,
	A.CODSBSCLIENTE					,
	A.FECREPORTE					,
	A.TIPDOCEMPRESA					,
	A.RUC							,
	A.TIPDOCIDENTIDAD				,
	A.DOCIDENTIDAD					,
	A.TIPPERSONA					,
	A.TIPEMPRESA					,
	A.CANTEMPRESA					,
	A.DEUDACALIFCLIENTE				,
	A.CLASIFDEUDACLIENTE			,
	B.UBIGEO						,
	B.SEXO							,
	A.RAZSOCOAP						,
	A.APMATERNO						,
	TRIM(A.NOMBRE1)||' '||TRIM(A.NOMBRE2),
	B.EDAD							,
	SYSDATE
FROM HM_CLIENTE A
LEFT JOIN MA_PERSONA B
ON A.DOCIDENTIDAD = B.DOCIDENTIDAD;

COMMIT;

DISCONNECT;
EXIT;