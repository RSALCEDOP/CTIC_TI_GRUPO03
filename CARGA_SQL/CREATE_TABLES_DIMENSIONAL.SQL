--============================================
-- 		ESPECIALIZACION BI & BIG DATA
--============================================

-- CREAC√çON DE TABLAS FINALES A NIVEL DIMENSIONAL - DATA MART 
CREATE TABLE DIM_UBIGEO(
UBIGEO					CHAR(6)		,
DEPARTAMENTO 			VARCHAR(13) ,
PROVINCIA				VARCHAR(25) ,
DISTRITO				VARCHAR(36) ,
FLGZONA					CHAR(4)		,
FLGCIUDAD				CHAR(1)		,
FECCARGATABLA			DATE		
)
;

CREATE TABLE DIM_CLIENTE(
CODMES					CHAR(6)		,
CODSBSCLIENTE			NUMBER      ,
FECREPORTE				VARCHAR(8)  ,
TIPDOCEMPRESA			CHAR(1)     ,
RUC						VARCHAR(15) ,
TIPDOCIDENTIDAD			CHAR(1)     ,
DOCIDENTIDAD			VARCHAR(10) ,
TIPPERSONA				CHAR(1)     ,
TIPEMPRESA				CHAR(1)     ,
CANTEMPRESA				NUMBER      ,
DEUDACALIFCLIENTE		NUMBER(8,2)	,
CLASIFDEUDACLIENTE		NUMBER		,
UBIGEO					CHAR(6)  	,
SEXO					NUMBER		,
APPATERNO				VARCHAR(30) ,
APMATERNO				VARCHAR(30) ,
NOMBRES					VARCHAR(30) ,
EDAD					NUMBER      ,
FECCARGATABLA			DATE
);

CREATE TABLE DIM_ENTIDAD_FINANCIERA(

CODENTIDAD        NUMBER,
BANCO             VARCHAR2(100),
BANCONOMCORTO     VARCHAR2(40),
TIPENTIDAD        VARCHAR2(50),
TIPCOMPETENCIA1   VARCHAR2(40),
TIPCOMPETENCIA2   VARCHAR2(40),
FECCARGATABLA     DATE
);

CREATE TABLE FAC_DEUDAS(
CODMES              CHAR(6)     ,
CODSBSCLIENTE       NUMBER      ,
CODENTIDAD          NUMBER      ,
CODPRODUCTO         NUMBER		,
CODSUBPRODUCTO      NUMBER		,
DEUDACALIFCLIENTE   NUMBER(8,2)	,
CLASIFDEUDACLIENTE  NUMBER      , 
SALDO               NUMBER(16,2),
FECCARGATABLA      DATE        
);

CREATE TABLE DIM_TIEMPO(
CODMES			CHAR(6)	,
ANIO			CHAR(4) ,
MES				CHAR(2) ,
FECCARGATABLA	DATE		
)
;

CREATE TABLE DIM_PRODUCTO(
CODPRODUCTO		NUMBER		,
PRODUCTO		VARCHAR(40) ,
CODSUBPRODUCTO 	NUMBER		,
SUBPRODUCTO		VARCHAR(40) 	
)
;