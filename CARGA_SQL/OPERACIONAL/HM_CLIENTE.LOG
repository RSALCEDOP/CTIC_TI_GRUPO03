SQL> 
SQL> --============================================
SQL> -- 	     ESPECIALIZACION BI & BIG DATA
SQL> --============================================
SQL> 
SQL> -- CARGA DE TABLA HM_CLIENTE
SQL> 
SQL> TRUNCATE TABLE HM_CLIENTE;

Table truncated.

Elapsed: 00:00:00.11
SQL> 
SQL> INSERT INTO HM_CLIENTE
  2  (
  3  	     CODMES					     ,
  4  	     TIPREGISTRO				     ,
  5  	     CODSBSCLIENTE			     ,
  6  	     FECREPORTE 				     ,
  7  	     TIPDOCEMPRESA			     ,
  8  	     RUC						     ,
  9  	     TIPDOCIDENTIDAD			     ,
 10  	     DOCIDENTIDAD			     ,
 11  	     TIPPERSONA 				     ,
 12  	     TIPEMPRESA 				     ,
 13  	     CANTEMPRESA				     ,
 14  	     DEUDACALIFNORMAL			     ,
 15  	     DEUDACALIFCPP			     ,
 16  	     DEUDACALIFDEFICIENTE	     ,
 17  	     DEUDACALIFDUDOSO			     ,
 18  	     DEUDACALIFPERDIDA			     ,
 19  	     DEUDACALIFCLIENTE			     ,
 20  	     CLASIFDEUDACLIENTE 		     ,
 21  	     RAZSOCOAP					     ,
 22  	     APMATERNO					     ,
 23  	     APCASADO					     ,
 24  	     NOMBRE1					     ,
 25  	     NOMBRE2
 26  )
 27  SELECT
 28  	     CODMES					     ,
 29  	     2							     ,
 30  	     TO_NUMBER(CODSBSCLIENTE)	     ,
 31  	     FECREPORTE 				 ,
 32  	     TIPDOCEMPRESA			 ,
 33  	     RUC						 ,
 34  	     TIPDOCIDENTIDAD			 ,
 35  	     DOCIDENTIDAD			 ,
 36  	     TIPPERSONA 				 ,
 37  	     TIPEMPRESA 				 ,
 38  	     CANTEMPRESA				 ,
 39  	     TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ','))	     ,
 40  	     TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ','))		     ,
 41  	     TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ','))      ,
 42  	     TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ','))	     ,
 43  	     TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ','))	 ,
 44  	     CASE
 45  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 46  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 47  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 48  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ','))
 49  	 WHEN TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 50  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 51  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 52  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ','))
 53  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 54  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 55  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 56  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ','))
 57  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 58  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 59  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 60  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ','))
 61  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 62  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 63  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 64  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) THEN TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ','))
 65  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 66  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 67  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 68  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 THEN TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ','))
 69  	     END DEUDACALIFCLIENTE   ,
 70  	     CASE
 71  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 72  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 73  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 74  		      TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN 0
 75  	 WHEN TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 76  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 77  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 78  		      TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN 1
 79  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 80  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 81  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) AND
 82  		      TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN 2
 83  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 84  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 85  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 86  		      TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) THEN 3
 87  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFNORMAL, '.', ',')) AND
 88  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFCPP, '.', ',')) AND
 89  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDEFICIENTE, '.', ',')) AND
 90  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) > TO_NUMBER(REPLACE(DEUDACALIFDUDOSO, '.', ',')) THEN 4
 91  	     WHEN TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 92  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 93  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 AND
 94  		      TO_NUMBER(REPLACE(DEUDACALIFPERDIDA, '.', ',')) = 0 THEN 0
 95  	     END CLASIFDEUDACLIENTE  ,
 96  	     RAZSOCOAP				     ,
 97  	     APMATERNO				     ,
 98  	     APCASADO				     ,
 99  	     NOMBRE1				     ,
100  	     NOMBRE2
101  FROM TMP_CLIENTE;

334776 rows created.

Elapsed: 00:00:06.97
SQL> 
SQL> COMMIT;

Commit complete.

Elapsed: 00:00:00.00
SQL> 
SQL> DISCONNECT;
Disconnected from Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
SQL> EXIT;
