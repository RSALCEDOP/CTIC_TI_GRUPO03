SQL> 
SQL> --============================================
SQL> -- 	     ESPECIALIZACION BI & BIG DATA
SQL> --============================================
SQL> 
SQL> -- CARGA DE TABLA HM_DEUDACLIENTE
SQL> 
SQL> TRUNCATE TABLE HM_DEUDACLIENTE;

Table truncated.

Elapsed: 00:00:00.02
SQL> 
SQL> INSERT INTO HM_DEUDACLIENTE
  2  (
  3  	     CODMES		      ,
  4  	     TIPREGISTRO	      ,
  5  	     CODSBSCLIENTE    ,
  6  	     CODENTIDAD 	      ,
  7  	     TIPCREDITO 	      ,
  8  	     CODCUENTA		      ,
  9  	     CODPRODUCTO	      ,
 10  	     CODSUBPRODUCTO   ,
 11  	     DIASATRASO 	      ,
 12  	     SALDO		      ,
 13  	     CLASIFICACION
 14  )
 15  SELECT
 16  	     A.CODMES			     ,
 17  	     A.TIPREGISTRO	     ,
 18  	     A.CODSBSCLIENTE	     ,
 19  	     A.CODENTIDAD	     ,
 20  	     A.TIPCREDITO	     ,
 21  	     A.CODCUENTA		     ,
 22  	     CASE
 23  	     WHEN A.CODSUBPRODUCTO = 1 THEN 1
 24  	     WHEN A.CODSUBPRODUCTO = 2 THEN 2
 25  	     WHEN A.CODSUBPRODUCTO IN (3,4) THEN 3
 26  	     WHEN A.CODSUBPRODUCTO IN (5,6) THEN 4
 27  	     WHEN A.CODSUBPRODUCTO IN (7,8) THEN 5
 28  	     WHEN A.CODSUBPRODUCTO = 9 THEN 6
 29  	     END CODPRODUCTO	     ,
 30  	     A.CODSUBPRODUCTO		     ,
 31  	     A.DIASATRASO	     ,
 32  	     A.SALDO			 ,
 33  	     A.CLASIFICACION
 34  FROM
 35  	     (SELECT
 36  		     REPLACE(CODMES,'"','')	     CODMES		     ,
 37  		     TO_NUMBER(TIPREGISTRO)	     TIPREGISTRO	     ,
 38  		     TO_NUMBER(CODSBSCLIENTE)	     CODSBSCLIENTE   ,
 39  		     TO_NUMBER(CODENTIDAD)	     CODENTIDAD 	     ,
 40  		     TIPCREDITO 			     ,
 41  		     CODCUENTA			     ,
 42  		     CASE
 43  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) ='09' THEN 1
 44  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) ='10' THEN 2
 45  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) ='13' AND SUBSTR(TRIM(CODCUENTA),7,2) NOT IN ('23','24', '25') THEN 3
 46  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) ='13' AND SUBSTR(TRIM(CODCUENTA),7,2) IN ('23','24', '25') THEN 4
 47  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) IN ('11','12') AND SUBSTR(TRIM(CODCUENTA),7,2) = ('06') AND SUBSTR(TRIM(CODCUENTA),7,4) <> '0602' THEN 5
 48  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) IN ('11','12') AND SUBSTR(TRIM(CODCUENTA),7,2) = ('06') AND SUBSTR(TRIM(CODCUENTA),7,4) = '0602' THEN 6
 49  		     WHEN SUBSTR(TRIM(CODCUENTA),4,1) IN ('1','3','4','5','6') AND SUBSTR(TRIM(CODCUENTA),1,2) ='14' AND TRIM(TIPCREDITO) IN ('11','12') AND SUBSTR(TRIM(CODCUENTA),7,2) = '02' THEN 7
 50  		     WHEN SUBSTR(TRIM(CODCUENTA),1,2) ='81' AND TRIM(TIPCREDITO) IN ('11','12') AND SUBSTR(TRIM(CODCUENTA),4,3) = '923' THEN 8
 51  		     ELSE 9
 52  		     END CODSUBPRODUCTO 						     ,
 53  		     TO_NUMBER(DIASATRASO)   DIASATRASO 		     ,
 54  		     TO_NUMBER(REPLACE(SALDO, '.', ','))     SALDO   ,
 55  		     TO_NUMBER(CLASIFICACION) CLASIFICACION
 56  	     FROM TMP_DEUDACLIENTE) A;

2099544 rows created.

Elapsed: 00:00:33.45
SQL> 
SQL> COMMIT;

Commit complete.

Elapsed: 00:00:00.00
SQL> 
SQL> DISCONNECT;
Disconnected from Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
SQL> EXIT;
